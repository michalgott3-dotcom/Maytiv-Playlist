<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>פלייליסט מיטיב - מרכז מיטיב, אוניברסיטת רייכמן</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .icon { display: inline-block; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const SongLibraryApp = () => {
          const [songs, setSongs] = useState([]);
          const [searchTerm, setSearchTerm] = useState('');
          const [selectedCategory, setSelectedCategory] = useState('הכל');
          const [currentlyPlaying, setCurrentlyPlaying] = useState(null);
          const [isAddingNew, setIsAddingNew] = useState(false);
          const [editingId, setEditingId] = useState(null);
          const [isLoading, setIsLoading] = useState(true);
          
          const [newSong, setNewSong] = useState({
            title: '',
            artist: '',
            category: '',
            url: '',
            type: 'link'
          });

          const [customCategories, setCustomCategories] = useState([]);
          const [newCategory, setNewCategory] = useState('');
          const [isConverting, setIsConverting] = useState(false);

          useEffect(() => {
            loadSongs();
            loadCategories();
          }, []);

          const loadSongs = () => {
            setIsLoading(true);
            try {
              const stored = localStorage.getItem('songs-library');
              if (stored) {
                setSongs(JSON.parse(stored));
              }
            } catch (error) {
              console.log('No existing songs found');
            }
            setIsLoading(false);
          };

          const loadCategories = () => {
            try {
              const stored = localStorage.getItem('song-categories');
              if (stored) {
                setCustomCategories(JSON.parse(stored));
              }
            } catch (error) {
              console.log('No existing categories found');
            }
          };

          const saveSongs = (updatedSongs) => {
            try {
              localStorage.setItem('songs-library', JSON.stringify(updatedSongs));
            } catch (error) {
              alert('שגיאה בשמירת השירים');
            }
          };

          const saveCategories = (updatedCategories) => {
            try {
              localStorage.setItem('song-categories', JSON.stringify(updatedCategories));
            } catch (error) {
              alert('שגיאה בשמירת הקטגוריות');
            }
          };

          const addCategory = () => {
            if (!newCategory.trim()) {
              alert('נא להזין שם נושא');
              return;
            }
            if (customCategories.includes(newCategory.trim())) {
              alert('נושא זה כבר קיים');
              return;
            }
            const updatedCategories = [...customCategories, newCategory.trim()];
            setCustomCategories(updatedCategories);
            saveCategories(updatedCategories);
            setNewCategory('');
          };

          const deleteCategory = (categoryToDelete) => {
            if (confirm(`האם אתה בטוח שברצונך למחוק את הנושא "${categoryToDelete}"?`)) {
              const updatedCategories = customCategories.filter(cat => cat !== categoryToDelete);
              setCustomCategories(updatedCategories);
              saveCategories(updatedCategories);
              
              const updatedSongs = songs.map(song => 
                song.category === categoryToDelete ? { ...song, category: '' } : song
              );
              setSongs(updatedSongs);
              saveSongs(updatedSongs);
              
              if (selectedCategory === categoryToDelete) {
                setSelectedCategory('הכל');
              }
            }
          };

          const categories = ['הכל', ...customCategories];

          const addSong = () => {
            if (!newSong.title || !newSong.artist || !newSong.category || !newSong.url) {
              alert('נא למלא את כל השדות');
              return;
            }

            setIsConverting(true);
